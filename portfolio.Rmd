---
title: "Mutations and Translational Impact in DEGs of ASD with comparison to SFARI"
output:
  html_notebook: 
    fig_width: 12
    fig_height: 8
    fig_caption: yes
  pdf_document: 
    fig_caption: yes
    fig_crop: no
    fig_width: 8
    fig_height: 6
    toc: yes
---
## 1. Abstract
주제에 대한 간략한 설명과 중심 질문에 대한 가설 성립을 바탕으로 전반적인 흐름에 대해 잠시 논하고 시작하도록 하자.
이 포트폴리오의 목적은 'Single-cell genomics identifies cell type–specific molecular changes in autism'의 data4,5을 이용해서 **SFARI gene과 비교하여 ASD의 DEG에서 나타나는 Mutation과 이에 따른 Translation Impact**을 확인하는 것에 있다. 

먼저 ASD의 DEG fold change을 cell type 별로 보고, <em>SFARI gene</em>과 비교하여 이 data4 상의 DEG임과 동시에 <em>SFARI gene</em>이기도 한 gene들을 찾는다.
<em>SFARI gene</em>과의 비교는 이를 통해 association with ASD 대한 신뢰도를 높이고자 함이다. 이렇게 찾은 특정 gene들의 mutation을 data5에서 살펴보고, 그로 인한 translation impact을 예측한다.
또한 이 "특정 gene"을 앞으로 gene with high reliablity, 즉 `HR_gene`이라 하자.

>SFARI Gene is an evolving database for the autism research community that is centered on genes implicated in autism susceptibility

본격적으로 data와 시각화 자료를 살펴보기에 앞서 특정 gene과 translation impact에 대한 가설을 성립해보자면, 아마 이 특정 gene은 ASD에 국한되어 영향을 미치는 것이 아니라 전반적인 대사과정에 중요한 역할을 맡고 있을 것이다. ASD가 단순히 유전자 1,2개의 이상으로 인한 genetic disorder가 아니고, 복잡한 de novo mutative polygenic disorder이기 때문이다. 

## 2. Data loading & analysis
### 2-1) Data4
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl)
library(ggrepel)
data4 <- readxl::read_xls("aav8130_Data-S4.xls")

head(data4)
```
이 중 `Cell type`, `Gene name`,`Fold change`, `SFARI gene`의 정보만이 필요하기 때문에 tidy format으로 새롭게 지정해준다. 
```{r}
d4 <- data4 %>% select(`Cell type`, `Gene name`, `Fold change`, `SFARI gene`) 
```
`Cell type`이 cell line에 대한 정보를 담고 있는데, ASD가 hetero geneous neurodevelopmental condition이라는 점에서 cell line 각각이 neuron인지 아닌지에 대한 정보도 추가로 담기로 한다.
```{r}
neuron = c("L2/3","L4","L5/6","L5/6-CC","Neu-mat","Neu-NRGN-I","Neu-NRGN-II","IN-PV","IN-SST","IN-VIP","IN-SV2C" )
d4 = d4 %>% mutate('neuron'= `Cell type` %in% neuron) %>% 
  mutate(neuron=ifelse(neuron=='TRUE','Neuro','Non-Neuro'),
        `SFARI gene`=ifelse(`SFARI gene`=='yes','SFARI','Non-SFARI')) %>%
  mutate(neuronal_SFARI=paste(neuron,`SFARI gene`,sep = '/')) 

head(d4)
```
### 2-2) Data5
```{r}
data5 <-read_xlsx('aav8130_Data-S5.xlsx', sheet = 2)
d5 <-data5 %>% select(DEG, cell_types,`Translation Impact`) %>%
  separate_rows(.,cell_types,sep = ',') 
d5$`Translation Impact`[is.na(d5$`Translation Impact`)]<-'not-defined'
d5$cell_types <- str_trim(d5$cell_types,side = "left")
d5$`Translation Impact`=factor(d5$`Translation Impact`,levels = c("missense","frameshift","in-frame","stop gain", "not-defined"))
head(d5)
```
## 3. Visualization
### 3-1) d4 Visualization
d4 visualization을 통해 `Cell type`별로 `DEG`의 `fold change`와 `neuron`, `SFARI gene`에 대한 정보를 scatterplot에 담았다.
```{r}
p_d4 <-d4 %>% ggplot(aes(`Gene name`,`Fold change`,col=`neuronal_SFARI`)) +
  scale_color_manual(breaks =                       c("Neuro/SFARI","Neuro/Non-SFARI","Non-Neuro/SFARI",'Non-Neuro/Non-SFARI'),
                     values=c('#2CA200','#FEE402','#0319FC','#66666D'))+
  geom_point(size=0.6, alpha=0.7) + 
  geom_hline(yintercept = 0.0, color= '#D7D6C6', alpha=0.7)+
  facet_wrap(~`Cell type`) + 
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank())

p_d4
```
이 때, point color에 대한 설명을 하자면 neuron은 노랑색, SFARI gene은 파랑색, 이 둘 모두에 속하면 두 색의 합인 초록색, 둘 모두에 속하지 않으면 회색으로 지정하였다.

### 3-2) d5 Visualization
d5 visualization을 통해 `cell type`별로의 `Translation Impact`에 대한 정보를 barplot에 담았다.
```{r}
p_d5_1 <- d5 %>% ggplot(aes(x=cell_types,y=`Translation Impact`, fill = `Translation Impact`)) +
  geom_bar(stat = "identity",position = "stack" ) +
  scale_fill_brewer(palette="Pastel2")+
  coord_flip()+
  ggtitle("Translation Impact by Cell type")+
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_blank(),
        panel.grid.major = element_blank())+
  labs(fill="mutation")

p_d5_1
```
전반적인 mutation 분포를 살펴볼 수 있다.

DEG 별로 어떤 mutation을 갖고 있는지 역시 확인해보자.
```{r,fig.width=6}
p_d5_2 <-d5 %>% ggplot(aes(cell_types,DEG,col=cell_types)) +
  geom_point(size=1.5, alpha=0.7) + 
  geom_hline(yintercept = 0.0, color= '#D7D6C6', alpha=0.7)+
  geom_label_repel(data = d5, aes(label=DEG),size=2.5)+
  facet_grid(`Translation Impact`~.)+ 
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_blank())
p_d5_2
```

### 3-3) Self Feedback Plot
위의 plot들을 통해 필요한 정보들을 시각화하여 볼 수 있다.
하지만 원하고자 하는 정보의 합산과 몇몇 사항의 수정이 필요해보인다.

먼저, data4와 data5의 DEG list가 다르기 때문에 p_d4 plot에서 볼 수 있는 `HR_gene`의 mutation type을 알기 위해서는 두 data의 DEG 중 겹치는 것이 있는지 알아봐야 한다.
또한  p_d4 plot의 경우 multipanel이 너무 많아 한 눈에 보기에 다소 복잡하다.
Neuron/Non-Neuron에 따라 나누어 볼 수 있도록 수정이 필요하다. 

일단 data5에 기재되어 있어서 mutation type을 확인할 수 있는 `HR_gene`을 찾고 표기해보자.
```{r}
d4 %>% filter(d4$`SFARI gene` == 'SFARI' & d4$`Gene name` %in% d5$DEG)
```
`HR_gene`은 **AKAP9**,**CACNA2D3**,**PTEN** 이다.

p_d5_2을 참고해서 `HR_gene`의 mutation type을 확인해보면 **AKAP9**는 frameshift, **CACNA2D3**와 **PTEN**은 missense가 발생하였다.

d4에 `HR_gene`과 `HR_gene`의 mutation type의 column을 추가하자.
```{r}
d4 <- d4 %>% mutate(HR_gene= ifelse(d4$`SFARI gene` == 'SFARI' & d4$`Gene name` %in% d5$DEG,TRUE, FALSE))
d4 <- d4 %>%mutate(HRG_mutation= paste(d4$`Gene name`)) 
d4$HRG_mutation <- gsub("AKAP9","AKAP9/frameshift",d4$HRG_mutation)
d4$HRG_mutation <-gsub("CACNA2D3","CACNA2D3/missense",d4$HRG_mutation) 
d4$HRG_mutation <-gsub("PTEN","PTEN/missense",d4$HRG_mutation,)
head(d4)
```
이제 최종 plot을 그려보자.
Neuron,Non-Neuron으로 나누어 각각 plot을 그린 뒤 plot_grid을 이용해 하나의 plot으로 합치고, `HR_gene`의 mutation type인 `HRG_mutaion`을 label로 표현할 것이다.
```{r, fig.width=6}
d4_N <- d4 %>% filter(neuron=='Neuro')
p1<- ggplot(d4_N, aes(`Gene name`,`Fold change`)) +
  geom_point(aes(col=`SFARI gene`), size=0.8, show.legend = TRUE)+  
  scale_color_manual(values = c("#FEE402","#2CA220"))+
  geom_hline(yintercept = 0.0, color= '#D7D6C6', alpha=0.7)+ 
  geom_label_repel(data=d4_N %>% filter(HR_gene==TRUE),aes(label=HRG_mutation),size=3.5, nudge_x = 0.3, nudge_y = 0.2)+
  facet_wrap(~`Cell type`) + 
  scale_y_continuous(breaks= c(-0.5, 0, 0.5))+
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_blank(),
        legend.position = "top",
        legend.background = element_rect(fill="lightblue", 
                                  size=0.5, linetype="solid")) 
p1
```


```{r, fig.width=6}
d4_NN <- d4 %>% filter(neuron=='Non-Neuro')        
p2 <- ggplot(d4_NN, aes(`Gene name`,`Fold change`)) +
  facet_wrap(~`Cell type`) + 
  geom_point(aes(col=`SFARI gene`),size=0.8,show.legend = TRUE) +
  scale_color_manual(values = c("#66666D","#0319FC"))+
  geom_hline(yintercept = 0.0, color= '#D7D6C6', alpha=0.8)+ 
  geom_label_repel(data=d4_NN %>% filter(HR_gene==TRUE),aes(label=HRG_mutation),size=3.5,nudge_x = 0.3, nudge_y = 0.2)+
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "top",
        legend.background = element_rect(fill="lightblue", 
                                  size=0.5, linetype="solid"))

p2
```
p1과 p2, 이 2가지 plot을 합쳐보자.
```{r, fig.width=6, fig.height=4.5}
library(cowplot)

plot_row <- plot_grid(
  p1,p2,labels = c('Neuron', 'Non Neuron'),rel_widths = c(2.7, 2),
  label_x = 0.4, label_y = 0.05, label_size = 15)

title <- ggdraw() +
  draw_label(
    "DEG Fold Change by Cell type (feat.SFARI) \n & Mutation Type of HR_gene",
    fontfamily = "serif",
    fontface = 'bold',
    color = '#0C1783',
    x = 0,
    hjust = 0,
    size = 20
  ) +
  theme(
    plot.margin = margin(0, 0, 0, 7),
    plot.caption = element_text(hjust=0.9, vjust = 1, size=9)
  )+
  labs(caption="labels indicate HR genes with known mutation type \n (HR_gene: DEGs included in SFARI database)")

final_plot <-plot_grid(
  title, plot_row,
   ncol = 1,
  rel_heights = c(0.1, 1)
)

final_plot
```
final plot을 통해 `HR_gene`인 **AKAP9**,**CACNA2D3**,**PTEN**의 `foldchange`가 각각 음수,음수,양수임을 알 수 있다.
이를 통해 up/down regulation 역시 확인 가능하다.

## 4. Conclusion
`HR_gene`이 어떤 gene인지, 체내에서 어떤 역할을 담당하고 있는지 간략히 알아보도록 하자.

<em>**AKAP9**</em>
:encoding A-kinase anchor protein 9.
AKAP9 protein plays an important role in centrosome duplication, cell cycle progression and maintenance of cell membrane integrity.

<em>**CACNA2D3**</em>
:encoding Calcium channel, voltage-dependent, alpha 2/delta subunit 3.

<em>**PTEN**</em> 
:encoding Phosphatase and tensin homolog (PTEN).
acts as a tumor suppressor gene through the action of its phosphatase protein product. 
PTEN protein is negative regulators of the PI3-kinase pathway, which regulates growth, survival, and proliferation. PTEN regulates PI3K signaling by dephosphorylating the lipid signaling intermediate PIP3.

또한 현재까지 밝혀진 `HR_gene`이 ASD에 미치는 영향과 어떻게 기여하는지 짚고 넘어갈 필요가 있다.

CACNA2D3는 calciun channel 합성을 조절하는 gene인데 뇌세포에서의 calcium pathway는 단순히 neuron 사이의 신경전달물질 뿐 아니라 calcium을 통한 다른 signaling pathway에도 영향을 주게된다. 이에 따라 CACNA2D3을 포함한 voltage-gated calcium channel의 이상은 ASD의 원인이 될 수 있다.
또한 ASD에서는 PI3K/AKT/MTOR pathway의 dysregulation이 관찰되는데 이 pathway에 PTEN 역시 포함되어 있다.

흥미로운 점은 이 3가지 gene 모두 tumor와의 연관성을 가지고 있다는 것이다. 

AKAP9의 경우 이 data에서 나타난 frameshift mutation 뿐 아니라 다른 somatic mutation 역시 high MSI을 보이며 gastric, colorectal 등의 cancer에 영향을 준다. 
CACNA2D3 역시 정상적인 gene은  intracellular calcium (Ca2+)을 증가시켜 apoptosis을 유도하거나 upregulation of NLK (through the Wnt/Ca2+pathway), EMT 억제 등을 하며 cancer cell에서 tumor suppressor의 모습을 보인다. 
PTEN은 유명한 tumor suppressor gene으로 DNA methylation 등의 이유로 PTEN에 mutation이 일어나게 되면 PI3K pathway의 negative feedback이 중단되어 PI3K pathway가 과도하게 활성화되며 tumor의 성장을 돕는다.

>MSI: microsatellite instability  EMT: epithelial‐to‐mesenchymal transition.

이가 시사하는 바는 많다.
먼저 `HR_gene`이 cell type에 따라서 cancer, 또는 뇌세포에 문제를 일으키는 뇌질환 등 세포의 이상으로 인한 여러가지 질병에 영향을 준다고 해석할 수 있다. 
즉, tumorigenesis에 영향을 줄 만큼 `HR_gene`이 전반적인 세포의 성장 및 대사 과정에 있어 중요한 역할을 하고 있기에 ASD뿐만 아니라 여러 질병에서 mutation을 나타낼 가능성이 있어서 `HR_gene`가 ASD에만 특이적인 ASD associated gene으로 보기에는 어렵다는 것이다.  
다른 방식으로 접근해보면 ASD와 cancer 사이의 연결고리를 찾을 수도 있다. 이를 통해 상호보완적인 therapeutic target을 발견한다면 더없이 좋을 것이다. 앞으로 이러한 점들을 고려하여 추가 분석 및 실험이 필요하다고 생각한다.

### Reference

1. Chalhoub. et al. (2009). PTEN and the PI3-Kinase Pathway in Cancer. Annual Review of Pathology: Mechanisms of Disease, 4(1), 127–150. https://doi.org/10.1146/annurev.pathol.4.110807.092311

2. Wanajo, A. et al (2008). Methylation of the Calcium Channel-Related Gene, CACNA2D3, Is Frequent and a Poor Prognostic Factor in Gastric Cancer. Gastroenterology, 135(2), 580-590.e3. https://doi.org/10.1053/j.gastro.2008.05.041

3. Jin, Y. et al (2017). CACNA2D3 is downregulated in gliomas and functions as a tumor suppressor: CACNA2D3 IS A TUMOR SUPPRESSOR IN GLIOMAS. Molecular Carcinogenesis, 56(3), 945–959. https://doi.org/10.1002/mc.22548

4. Nie, C. et al (2019). CACNA2D3 Enhances the Chemosensitivity of Esophageal Squamous Cell Carcinoma to Cisplatin via Inducing Ca2+-Mediated Apoptosis and Suppressing PI3K/Akt Pathways. Frontiers in Oncology, 9, 185. https://doi.org/10.3389/fonc.2019.00185

5. Forés-Martos, J. et al (2019). Transcriptomic metaanalyses of autistic brains reveals shared gene expression and biological pathway abnormalities with cancer. Molecular Autism, 10(1), 17. https://doi.org/10.1186/s13229-019-0262-8

6. iao, X., & Li, Y. (2020). Genetic associations between voltage-gated calcium channels and autism spectrum disorder: A systematic review. Molecular Brain, 13(1), 96. https://doi.org/10.1186/s13041-020-00634-0

7. Forés-Martos, J.et al (2019). Transcriptomic metaanalyses of autistic brains reveals shared gene expression and biological pathway abnormalities with cancer. Molecular Autism, 10(1), 17. https://doi.org/10.1186/s13229-019-0262-8




